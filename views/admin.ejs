<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
        .dashboard { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* Cabe√ßalho */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .logout { color: red; text-decoration: none; font-weight: bold; }
        
        /* Cards de Resumo */
        .resumo { display: flex; gap: 15px; margin-bottom: 30px; }
        .card-resumo { flex: 1; padding: 15px; border-radius: 8px; text-align: center; color: white; }
        .bg-azul { background: #007bff; }
        .bg-verde { background: #28a745; }
        .bg-laranja { background: #ffc107; color: #333; }

        /* Filtros */
        .filtros { margin-bottom: 15px; }
        .btn-filtro { padding: 8px 15px; text-decoration: none; color: #333; border: 1px solid #ccc; border-radius: 20px; margin-right: 5px; font-size: 14px; }
        .btn-filtro.ativo { background: #333; color: white; border-color: #333; }

        /* Tabela */
        table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }
        th, td { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }
        th { background: #eee; }
        .status-Pago { color: green; font-weight: bold; }
        .status-Pendente { color: orange; font-weight: bold; }

        /* A√ß√µes */
        .btn-acao { padding: 5px 10px; border-radius: 4px; text-decoration: none; color: white; font-size: 12px; }
        .btn-edit { background: #17a2b8; }
        .btn-whats { background: #25d366; }

        /* √Årea da Galeria */
        .galeria-admin { border-top: 2px dashed #ccc; padding-top: 20px; margin-top: 20px; }
        .form-midia { background: #eee; padding: 15px; border-radius: 5px; display: flex; gap: 10px; align-items: center; }
        .lista-midia { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px; }
        .item-midia { width: 100px; height: 100px; position: relative; border: 1px solid #ddd; }
        .item-midia img { width: 100%; height: 100%; object-fit: cover; }
        .btn-del-midia { position: absolute; top: 0; right: 0; background: red; color: white; width: 20px; height: 20px; text-align: center; text-decoration: none; font-size: 12px; }
    </style>
</head>
<body>

<div class="dashboard">
    <div class="top-bar">
        <h1>Painel de Controle</h1>
        <a href="/logout" class="logout">Sair</a>
    </div>

   <div class="resumo">
        <div class="card-resumo bg-azul">
            <h3><%= total %></h3>
            <small>Total</small>
        </div>
        <div class="card-resumo bg-verde">
            <h3><%= pagos %></h3>
            <small>Pagos</small>
        </div>
        <div class="card-resumo" style="background: #3498db;">
            <h3><%= meninos %></h3>
            <small>Meninos üë¶</small>
        </div>
        <div class="card-resumo" style="background: #e84393;">
            <h3><%= meninas %></h3>
            <small>Meninas üëß</small>
        </div>
    </div>
    <hr>

    <h2>Inscri√ß√µes</h2>
    
    <div class="filtros">
        <strong>Filtrar:</strong>
        <a href="/admin" class="btn-filtro <%= !filtroAtual ? 'ativo' : '' %>">Todos</a>
        <a href="/admin?filtro=Pago" class="btn-filtro <%= filtroAtual === 'Pago' ? 'ativo' : '' %>">Pagos</a>
        <a href="/admin?filtro=Pendente" class="btn-filtro <%= filtroAtual === 'Pendente' ? 'ativo' : '' %>">Pendentes</a>
    </div>

<table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Sexo</th> <th>CPF</th>  <th>Congrega√ß√£o</th>
                <th>Status</th>
                <th>Valor</th> <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody>
            <% inscritos.forEach(function(p) { %>
                <tr>
                    <td>#<%= p.id %></td>
                    <td><%= p.nome %></td>
                    <td><%= p.sexo %></td>
                    <td><%= p.cpf %></td>
                    <td><%= p.congregacao %></td>
                    <td class="status-<%= p.status %>"><%= p.status %></td>
                    <td>R$ <%= p.valor_pago %></td>
                    <td>
                        <a href="/admin/editar/<%= p.id %>" class="btn-acao btn-edit">‚úè</a>
                        <a href="https://wa.me/55<%= p.telefone.replace(/\D/g, '') %>" target="_blank" class="btn-acao btn-whats">üì±</a>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>

    <div class="galeria-admin">
        <h2>Gerenciar Galeria do Site</h2>
        <p>Adicione links de fotos (Instagram, Google Fotos, etc) ou v√≠deos.</p>
        
<form action="/admin/galeria/adicionar" method="POST" enctype="multipart/form-data" class="form-midia">
            
            <select name="tipo" style="padding: 10px;">
                <option value="foto">Foto</option>
                <option value="video">V√≠deo</option>
            </select>
            
            <input type="file" name="arquivo" required style="flex: 1; padding: 10px; background: white;">
            
            <input type="text" name="titulo" placeholder="Legenda (opcional)" style="padding: 10px;">
            <button type="submit" style="padding: 10px; background: #667eea; color: white; border: none; cursor: pointer;">Enviar Arquivo</button>
        </form>

        <div class="lista-midia">
            <% galeria.forEach(function(m) { %>
                <div class="item-midia">
                    <% if (m.tipo === 'foto') { %>
                        <img src="<%= m.url %>">
                    <% } else { %>
                        <div style="background: black; color: white; height: 100%; display: flex; justify-content: center; align-items: center; font-size: 10px;">V√çDEO</div>
                    <% } %>
                    <a href="/admin/galeria/deletar/<%= m.id %>" class="btn-del-midia" onclick="return confirm('Apagar?')">X</a>
                </div>
            <% }); %>
        </div>
    </div>

</div>

</body>
</html>